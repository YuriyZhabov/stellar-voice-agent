# Дополнительные настройки безопасности SSH

# Ограничение попыток аутентификации
MaxAuthTries 3
MaxSessions 2

# Таймауты для неактивных соединений
ClientAliveInterval 300
ClientAliveCountMax 2

# Отключение пустых паролей
PermitEmptyPasswords no

# Отключение X11 forwarding (если не нужен)
X11Forwarding no

# Отключение TCP forwarding (если не нужен)
AllowTcpForwarding no

# Отключение Agent forwarding (если не нужен)
AllowAgentForwarding no

# Отключение GSSAPI аутентификации (если не используется)
GSSAPIAuthentication no

# Использование только SSH протокола версии 2
Protocol 2

# Ограничение времени на логин
LoginGraceTime 30

# Показывать только последний логин
PrintLastLog yes

# Строгая проверка режимов файлов
StrictModes yes

# Отключение .rhosts файлов
IgnoreRhosts yes

# Отключение host-based аутентификации
HostbasedAuthentication no

# Отключение challenge-response аутентификации
ChallengeResponseAuthentication no

# Отключение Kerberos аутентификации
KerberosAuthentication no

# Использование только сильных алгоритмов шифрования
Ciphers chacha20-poly1305@openssh.com,aes256-gcm@openssh.com,aes128-gcm@openssh.com,aes256-ctr,aes192-ctr,aes128-ctr

# Использование только сильных MAC алгоритмов
MACs hmac-sha2-256-etm@openssh.com,hmac-sha2-512-etm@openssh.com,hmac-sha2-256,hmac-sha2-512

# Использование только сильных алгоритмов обмена ключами
KexAlgorithms curve25519-sha256@libssh.org,diffie-hellman-group16-sha512,diffie-hellman-group18-sha512,diffie-hellman-group14-sha256